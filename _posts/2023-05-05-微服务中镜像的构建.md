---
layout: post
title: "微服务中镜像的构建"
tags: [docker]
excerpt_separator: <!--more-->
date: 2023-05-05
---

> 微服务中涉及到基础服务镜像、初始化镜像、后端镜像等，这些镜像如何构建？
> 以之前提到的博客系统为例，讲解在微服务中各类镜像是如何构建的。
## 1. 基础服务镜像的构建  
基础服务，指mariadb、redis等需要提供基础服务的组件。以mariadb为例，mariadb镜像需要提供数据库服务，直接使用DockerHub中已经构建好的mariadb镜像，本地可以拉取镜像，打上自己的tag  <!--more-->
```
# 构建mariadb基础镜像
sudo docker pull mariadb:latest
sudo docker tag mariadb:latest mariadb:20200329_204923
```
## 2. mariadb初始化镜像的构建  
初始化镜像主要是执行sql语句建库建表，需要用到mysql client，主要用到mysql的**source**命令。先拉取这个镜像  
```
# 构建mariadb初始化基础镜像
# 镜像来源：https://registry.hub.docker.com/r/arey/mysql-client
sudo docker pull arey/mysql-client:latest
sudo docker tag arey/mysql-client:latest mysql-client:20210809_194301
```
再需要把sql语句放到这个镜像中  
先看下构建这个镜像需要哪些文件
![镜像构建文件](https://raw.githubusercontent.com/leanfish2011/data/main/img/mariadb_init.jpg)



TODO 打镜像脚本说明
